<!DOCTYPE html>
<html lang="en"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}"
      xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
  <style>
    .auth-container {
      min-height: auto;
      padding: 2rem 0;
    }
    .auth-card {
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      border: none;
      margin: 0 auto;
    }
    .auth-logo {
      max-height: 70px;
      margin-bottom: 1rem;
    }
    .two-column-form {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }
    .full-width {
      grid-column: 1 / -1;
    }
    @media (max-width: 992px) {
      .two-column-form {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
<section layout:fragment="content">
  <div class="container auth-container">
    <div class="row justify-content-center">
      <div class="col-12 col-xl-10">
        <div class="card auth-card">
          <div class="card-body p-4 p-md-5">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="text-center mb-4">
              <img src="/images/soilcare-logo.png" alt="SoilCare" class="auth-logo">
              <h3 class="mt-2">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
              <p class="text-muted">–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç</p>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
            <div th:if="${error}" class="alert alert-danger full-width" role="alert">
              <i class="bi bi-exclamation-triangle me-2"></i>
              <span th:text="${error}"></span>
            </div>

            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ 2 —Å—Ç–æ–ª–±—Ü–∞ -->
            <form th:action="@{/auth/register}" th:object="${user}" method="post" class="two-column-form">
              <!-- –õ–µ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü -->
              <div class="left-column">
                <h5 class="mb-3 text-primary">
                  <i class="bi bi-person me-2"></i>–õ–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                </h5>

                <div class="mb-3">
                  <label class="form-label">–ò–º—è *</label>
                  <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="bi bi-person"></i>
                                        </span>
                    <input type="text" class="form-control" th:field="*{firstName}"
                           placeholder="–í–∞—à–µ –∏–º—è" required>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label">–§–∞–º–∏–ª–∏—è *</label>
                  <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="bi bi-person-badge"></i>
                                        </span>
                    <input type="text" class="form-control" th:field="*{lastName}"
                           placeholder="–í–∞—à–∞ —Ñ–∞–º–∏–ª–∏—è" required>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label">Email *</label>
                  <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="bi bi-envelope"></i>
                                        </span>
                    <input type="email" class="form-control" th:field="*{email}"
                           placeholder="example@mail.com" required>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                  <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="bi bi-phone"></i>
                                        </span>
                    <input type="tel" class="form-control" th:field="*{phone}"
                           placeholder="+7 (999) 999-99-99">
                  </div>
                </div>
              </div>

              <!-- –ü—Ä–∞–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü -->
              <div class="right-column">
                <h5 class="mb-3 text-primary">
                  <i class="bi bi-shield-lock me-2"></i>–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                </h5>

                <div class="mb-3">
                  <label class="form-label">–õ–æ–≥–∏–Ω *</label>
                  <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="bi bi-person-circle"></i>
                                        </span>
                    <input type="text" class="form-control" th:field="*{username}"
                           placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω" required>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label">–ü–∞—Ä–æ–ª—å *</label>
                  <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="bi bi-lock"></i>
                                        </span>
                    <input type="password" class="form-control" th:field="*{password}"
                           placeholder="–ù–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤" required>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è *</label>
                  <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="bi bi-lock-fill"></i>
                                        </span>
                    <input type="password" class="form-control" name="confirmPassword"
                           placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                  </div>
                </div>

                <div class="mb-3">
                  <label class="form-label">–†–æ–ª—å</label>
                  <select class="form-select" th:field="*{role}">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å</option>
                    <option th:each="roleItem : ${roles}"
                            th:value="${roleItem}"
                            th:selected="${roleItem == role}"
                            th:text="${roleItem.name() == 'USER' ? 'üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å' :
                     roleItem.name() == 'SELLER' ? 'üè™ –ü—Ä–æ–¥–∞–≤–µ—Ü' :
                     '‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'}">
                    </option>
                  </select>
                  <div class="form-text">
                    –í—ã–±–µ—Ä–∏—Ç–µ "–ü—Ä–æ–¥–∞–≤–µ—Ü" –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–∞–≤–∞—Ç—å —É–¥–æ–±—Ä–µ–Ω–∏—è
                  </div>
                </div>
              </div>


              <div class="full-width">
                <hr>
              </div>

              <div class="full-width">
                <div class="mb-3 form-check">
                  <input type="checkbox" class="form-check-input" id="terms" required>
                  <label class="form-check-label" for="terms">
                    –Ø —Å–æ–≥–ª–∞—à–∞—é—Å—å —Å
                    <a href="#" class="text-decoration-none">—É—Å–ª–æ–≤–∏—è–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
                    –∏
                    <a href="#" class="text-decoration-none">–ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                  </label>
                </div>
              </div>

              <div class="full-width">
                <button type="submit" class="btn btn-success w-100 py-2 mb-3">
                  <i class="bi bi-person-plus me-2"></i>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                </button>
              </div>

              <div class="full-width text-center">
                <span class="text-muted">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? </span>
                <a th:href="@{/auth/login}" class="text-decoration-none">–í–æ–π—Ç–∏</a>
              </div>
            </form>
          </div>
        </div>



      </div>
    </div>
  </div>

  <script>

    document.addEventListener('DOMContentLoaded', function() {
      const phoneInput = document.querySelector('input[type="tel"]');
      if (phoneInput) {
        phoneInput.addEventListener('input', function(e) {
          let value = e.target.value.replace(/\D/g, '');
          if (value.length > 0) {
            value = '+7 (' + value;
            if (value.length > 7) value = value.slice(0, 7) + ') ' + value.slice(7);
            if (value.length > 12) value = value.slice(0, 12) + '-' + value.slice(12);
            if (value.length > 15) value = value.slice(0, 15) + '-' + value.slice(15);
          }
          e.target.value = value;
        });
      }


      const password = document.querySelector('input[th\\:field="*{password}"]');
      const confirmPassword = document.querySelector('input[name="confirmPassword"]');

      if (password && confirmPassword) {
        confirmPassword.addEventListener('blur', function() {
          if (password.value !== confirmPassword.value) {
            confirmPassword.setCustomValidity('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
          } else {
            confirmPassword.setCustomValidity('');
          }
        });
      }
    });
  </script>
</section>
</body>
</html>